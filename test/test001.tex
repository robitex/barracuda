% !TeX program = LuaTeX

\newbox\mybox

\directlua{
local barracuda = dofile "../src/Barracuda.lua"
barracuda:init("/media/roberto/project/barracuda/src")

local c39builder, err = barracuda:load_builder("code39")
assert(not err, err)

local enc_c39_default, err = c39builder:new_encoder("default")
assert(not err, err)

enc_c39_default:set_param("quietzone", tex.sp "5mm")

local symb = enc_c39_default:from_string("ORTEIL")
symb:set_param("height" ,5000000)

local canvas = barracuda:new_canvas()
symb:append_graphic(canvas)

local drv, err = barracuda:load_driver("native")
assert(not err, err)

print([[****canvas****]])
for _, opcode in ipairs(canvas._data) do
    print(opcode)
end
print([[****canvas****]])

drv:ga_to_hbox(canvas, "mybox")
}

A\box\mybox A


\bye
